# Handle  GiveMeTestEther   # Vulnerability details  ## Impact  Functions in the same contract with the same access modifier (e.g. onlyOwner or onlyFactory) have have a mix of public and external visibility.  Set their visibility to external to save gas.  Affected contracts (see ): - NestedRecords - NestedFactory - FeeSplitter - NestedAsset   ## Tools Used Visial Studio Code + Solidity Visual Developer (Plugin)  ## Recommended Mitigation Steps  Set the visibility to external to save gas.   Extract from Solidity Visual Developer (Plugin) of the Contracts and visibility:  |  Contract  |         Type        |       Bases      |                  |                 | |:----------:|:-------------------:|:----------------:|:----------------:|:---------------:| |     â””      |  **Function Name**  |  **Visibility**  |  **Mutability**  |  **Modifiers**  | |||||| | **NestedRecords** | Implementation | Ownable ||| | â”” | <Constructor> | Public â—ï¸ | ğŸ›‘  |NOâ—ï¸ | | â”” | createRecord | Public â—ï¸ | ğŸ›‘  | onlyFactory | | â”” | updateHoldingAmount | Public â—ï¸ | ğŸ›‘  | onlyFactory | | â”” | getAssetTokens | Public â—ï¸ |   |NOâ—ï¸ | | â”” | freeHolding | Public â—ï¸ | ğŸ›‘  | onlyFactory | | â”” | store | External â—ï¸ | ğŸ›‘  | onlyFactory | | â”” | getAssetHolding | External â—ï¸ |   |NOâ—ï¸ | | â”” | setFactory | External â—ï¸ | ğŸ›‘  | onlyOwner | | â”” | updateLockTimestamp | External â—ï¸ | ğŸ›‘  | onlyFactory | | â”” | setMaxHoldingsCount | External â—ï¸ | ğŸ›‘  | onlyOwner | | â”” | getAssetReserve | External â—ï¸ |   |NOâ—ï¸ | | â”” | getAssetTokensLength | External â—ï¸ |   |NOâ—ï¸ | | â”” | getLockTimestamp | External â—ï¸ |   |NOâ—ï¸ | | â”” | setReserve | External â—ï¸ | ğŸ›‘  | onlyFactory | | â”” | removeNFT | External â—ï¸ | ğŸ›‘  | onlyFactory | | â”” | deleteAsset | Public â—ï¸ | ğŸ›‘  | onlyFactory | | â”” | freeToken | Private ğŸ” | ğŸ›‘  | | |||||| | **NestedFactory** | Implementation | INestedFactory, ReentrancyGuard, Ownable, MixinOperatorResolver, Multicall ||| | â”” | <Constructor> | Public â—ï¸ | ğŸ›‘  | MixinOperatorResolver | | â”” | <Receive Ether> | External â—ï¸ |  ğŸ’µ |NOâ—ï¸ | | â”” | resolverAddressesRequired | Public â—ï¸ |   |NOâ—ï¸ | | â”” | addOperator | External â—ï¸ | ğŸ›‘  | onlyOwner | | â”” | removeOperator | External â—ï¸ | ğŸ›‘  | onlyOwner | | â”” | setReserve | External â—ï¸ | ğŸ›‘  | onlyOwner | | â”” | setFeeSplitter | External â—ï¸ | ğŸ›‘  | onlyOwner | | â”” | create | External â—ï¸ |  ğŸ’µ | nonReentrant | | â”” | addTokens | External â—ï¸ |  ğŸ’µ | nonReentrant onlyTokenOwner | | â”” | swapTokenForTokens | External â—ï¸ | ğŸ›‘  | nonReentrant onlyTokenOwner isUnlocked | | â”” | sellTokensToNft | External â—ï¸ | ğŸ›‘  | nonReentrant onlyTokenOwner isUnlocked | | â”” | sellTokensToWallet | External â—ï¸ | ğŸ›‘  | nonReentrant onlyTokenOwner isUnlocked | | â”” | destroy | External â—ï¸ | ğŸ›‘  | nonReentrant onlyTokenOwner isUnlocked | | â”” | withdraw | External â—ï¸ | ğŸ›‘  | nonReentrant onlyTokenOwner isUnlocked | | â”” | increaseLockTimestamp | External â—ï¸ | ğŸ›‘  | onlyTokenOwner | | â”” | unlockTokens | External â—ï¸ | ğŸ›‘  | onlyOwner | | â”” | _submitInOrders | Private ğŸ” | ğŸ›‘  | | | â”” | _submitOutOrders | Private ğŸ” | ğŸ›‘  | | | â”” | _submitOrder | Private ğŸ” | ğŸ›‘  | | | â”” | _safeSubmitOrder | Private ğŸ” | ğŸ›‘  | | | â”” | _transferToReserveAndStore | Private ğŸ” | ğŸ›‘  | | | â”” | _transferInputTokens | Private ğŸ” | ğŸ›‘  | | | â”” | _handleUnderSpending | Private ğŸ” | ğŸ›‘  | | | â”” | _transferFeeWithRoyalty | Private ğŸ” | ğŸ›‘  | | | â”” | _decreaseHoldingAmount | Private ğŸ” | ğŸ›‘  | | | â”” | _safeTransferAndUnwrap | Private ğŸ” | ğŸ›‘  | | | â”” | _safeTransferWithFees | Private ğŸ” | ğŸ›‘  | | | â”” | _calculateFees | Private ğŸ” |   | | |||||| | **FeeSplitter** | Implementation | Ownable, ReentrancyGuard ||| | â”” | <Constructor> | Public â—ï¸ | ğŸ›‘  |NOâ—ï¸ | | â”” | <Receive Ether> | External â—ï¸ |  ğŸ’µ |NOâ—ï¸ | | â”” | getAmountDue | Public â—ï¸ |   |NOâ—ï¸ | | â”” | setRoyaltiesWeight | Public â—ï¸ | ğŸ›‘  | onlyOwner | | â”” | setShareholders | Public â—ï¸ | ğŸ›‘  | onlyOwner | | â”” | releaseToken | Public â—ï¸ | ğŸ›‘  | nonReentrant | | â”” | releaseTokens | External â—ï¸ | ğŸ›‘  |NOâ—ï¸ | | â”” | releaseETH | External â—ï¸ | ğŸ›‘  | nonReentrant | | â”” | sendFees | External â—ï¸ | ğŸ›‘  | nonReentrant | | â”” | sendFeesWithRoyalties | External â—ï¸ | ğŸ›‘  | nonReentrant | | â”” | updateShareholder | External â—ï¸ | ğŸ›‘  | onlyOwner | | â”” | totalShares | External â—ï¸ |   |NOâ—ï¸ | | â”” | totalReleased | External â—ï¸ |   |NOâ—ï¸ | | â”” | shares | External â—ï¸ |   |NOâ—ï¸ | | â”” | released | External â—ï¸ |   |NOâ—ï¸ | | â”” | findShareholder | External â—ï¸ |   |NOâ—ï¸ | | â”” | _sendFees | Private ğŸ” | ğŸ›‘  | | | â”” | _addShares | Private ğŸ” | ğŸ›‘  | | | â”” | _releaseToken | Private ğŸ” | ğŸ›‘  | | | â”” | _addShareholder | Private ğŸ” | ğŸ›‘  | | | â”” | _computeShareCount | Private ğŸ” |   | | |||||| | **NestedAsset** | Implementation | ERC721Enumerable, Ownable ||| | â”” | <Constructor> | Public â—ï¸ | ğŸ›‘  | ERC721 | | â”” | tokenURI | Public â—ï¸ |   |NOâ—ï¸ | | â”” | originalOwner | Public â—ï¸ |   |NOâ—ï¸ | | â”” | mint | Public â—ï¸ | ğŸ›‘  | onlyFactory | | â”” | mintWithMetadata | External â—ï¸ | ğŸ›‘  | onlyFactory | | â”” | backfillTokenURI | External â—ï¸ | ğŸ›‘  | onlyFactory onlyTokenOwner | | â”” | burn | External â—ï¸ | ğŸ›‘  | onlyFactory onlyTokenOwner | | â”” | setFactory | External â—ï¸ | ğŸ›‘  | onlyOwner | | â”” | removeFactory | External â—ï¸ | ğŸ›‘  | onlyOwner | | â”” | _setTokenURI | Internal ğŸ”’ | ğŸ›‘  | |   Legend  |  Symbol  |  Meaning  | |:--------:|-----------| |    ğŸ›‘    | Function can modify state | |    ğŸ’µ    | Function is payable |   
